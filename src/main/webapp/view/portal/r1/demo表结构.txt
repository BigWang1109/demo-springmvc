CREATE TABLE "FSOPR1"."T_USER" 
   (	"ID" VARCHAR2(64), 
	"USERNAME" VARCHAR2(64), 
	"LOGINNAME" VARCHAR2(64), 
	"GENDER" NUMBER, 
	"ORGCODE" VARCHAR2(64), 
	"EMAIL" VARCHAR2(64), 
	"CREATETIME" DATE, 
	"ROLENAMES" VARCHAR2(128), 
	"ORGID" VARCHAR2(64), 
	"XMLDATA" CLOB, 
	 CONSTRAINT "T_USER_ID" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" 
 LOB ("XMLDATA") STORE AS BASICFILE (
  TABLESPACE "FSOPR1" ENABLE STORAGE IN ROW CHUNK 8192 RETENTION 
  NOCACHE LOGGING 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
 
  CREATE UNIQUE INDEX "FSOPR1"."T_USER_ID" ON "FSOPR1"."T_USER" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" ;
 
  CREATE UNIQUE INDEX "FSOPR1"."SYS_IL0000085224C00010$$" ON "FSOPR1"."T_USER" (
  PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" 
  PARALLEL (DEGREE 0 INSTANCES 0) ;
 
  ALTER TABLE "FSOPR1"."T_USER" ADD CONSTRAINT "T_USER_ID" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE;












CREATE TABLE "FSOPR1"."T_ROLE" 
   (	"ROLEID" VARCHAR2(36), 
	"ORDERINDEX" NUMBER(*,0), 
	"CATEGORY" VARCHAR2(50), 
	"ROLENAME" VARCHAR2(50), 
	"ROLECODE" VARCHAR2(50), 
	"DESCRIPTION" VARCHAR2(254), 
	 PRIMARY KEY ("ROLEID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 8192 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" ;
 
  CREATE UNIQUE INDEX "FSOPR1"."SYS_C0018056" ON "FSOPR1"."T_ROLE" ("ROLEID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" ;
 
  ALTER TABLE "FSOPR1"."T_ROLE" ADD PRIMARY KEY ("ROLEID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE;











CREATE TABLE "FSOPR1"."T_RESOURCE" 
   (	"ID" VARCHAR2(36), 
	"PARENTID" VARCHAR2(36), 
	"ORDERINDEX" NUMBER(*,0), 
	"CATEGORY" VARCHAR2(50), 
	"RESOURCENAME" VARCHAR2(50), 
	"RESOURCECODE" VARCHAR2(50), 
	"URI" VARCHAR2(50), 
	"ISUSED" NUMBER(*,0), 
	"DESCRIPTION" VARCHAR2(254), 
	 PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" ;
 
  CREATE UNIQUE INDEX "FSOPR1"."SYS_C0018053" ON "FSOPR1"."T_RESOURCE" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" ;
 
  ALTER TABLE "FSOPR1"."T_RESOURCE" ADD PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE;










CREATE TABLE "FSOPR1"."T_ORGTREE" 
   (	"ID" VARCHAR2(64), 
	"PARENTID" VARCHAR2(64), 
	"ORGCODE" VARCHAR2(64), 
	"ORGNAME" VARCHAR2(128), 
	"LEVERCODE" VARCHAR2(254), 
	"STATE" NUMBER(*,0), 
	 CONSTRAINT "T_ORGTREE_ID" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" ;
 
  CREATE UNIQUE INDEX "FSOPR1"."T_ORGTREE_ID" ON "FSOPR1"."T_ORGTREE" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1" ;
 
  ALTER TABLE "FSOPR1"."T_ORGTREE" ADD CONSTRAINT "T_ORGTREE_ID" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "FSOPR1"  ENABLE;







insert into t_orgtree(id, parentid, orgcode, orgname, levercode, state)
select orguuid id, parentorguuid parentid, orgcode, cnname orgname, orglevelcode levercode, status state from ro_org t where length(cnname)<128




insert into t_user(id, username, loginname, gender, orgcode, email, createtime) 
select id, username, loginname, gender, orgcode, email, createtime from (

    select a.personuuid id, a.full_name username, b.userid loginname, 1 gender, 
    d.orgcode, a.email, a.createtime  
    from ro_person a 
    left join ro_personaccount b on a.personuuid = b.personuuid
    left join ro_orgperson c on a.personuuid= c.personuuid
    left join ro_org d on c.orguuid=d.orguuid
    where length(a.full_name)<50
    
) u
where u.id in(
      select id from (
       
        select a.personuuid id, a.full_name username, b.userid loginname, 1 gender, 
        d.orgcode, a.email, a.createtime  
        from ro_person a 
        left join ro_personaccount b on a.personuuid = b.personuuid
        left join ro_orgperson c on a.personuuid= c.personuuid
        left join ro_org d on c.orguuid=d.orguuid
        where length(a.full_name)<50
        
       ) group by id having count(*) = 1
)





-- 查询模块id  更新 AdminFlag=1
select * from ro_module t where t.modulename='内容管理' or t.modulename='栏目管理'
or t.modulename='静态化资源' or t.modulename='发布权限管理' for update

-- 查询应用
select * from ro_application t

-- 查询应用模块关系
select * from ro_appmodule t where t.muuid='6d512c8b-f64b235365-8bc57d46865df488c953bdf7dcb6d6b9'
or t.muuid='4028836852f2a44d0152f8906032024d'

-- 更新应用模块关系，更新为管理控制台应用 449df8ef-f640ccf5ca-d222347e77add7e1f5b37163b1fd56a8
-- AdminFlag=1 内容发布管理 4028836852f2a44d0152f89004a9024c
update ro_appmodule set appuuid='449df8ef-f640ccf5ca-d222347e77add7e1f5b37163b1fd56a8'
where muuid='4028836852f2a44d0152f8b393f4027a' 
or muuid = '4028836852f2a44d0152f8b440fd027c'
or muuid = '4028836852f2a44d0152f8906032024d'
or muuid = '4028836852f2a44d0152f8ad6b8c0278'

update ro_appmodule set appuuid='4028836852f2a44d0152f89004a9024c'
where muuid='4028836852f2a44d0152f8b393f4027a' 
or muuid = '4028836852f2a44d0152f8b440fd027c'
or muuid = '4028836852f2a44d0152f8906032024d'
or muuid = '4028836852f2a44d0152f8ad6b8c0278'


-- 修改模块组 
select * from ro_modulegroup t where t.cnname ='门户展现' or t.cnname='内容管理' for update



